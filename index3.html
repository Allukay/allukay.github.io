<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Clique...</title>
<style>
  :root{
    --stroke: #ff2d55;
    --fill: #ff3b61;
    --bg1: #0f0c29;
    --bg2: #302b63;
    --bg3: #24243e;
  }
  body{
    margin:0;
    min-height:100vh;
    display:grid;
    place-items:center;
    background: radial-gradient(1200px 800px at 50% 40%, var(--bg2), var(--bg3) 60%, var(--bg1) 100%);
    color:#fff;
    overflow:hidden;
  }
  .wrap{
    display:grid;
    place-items:center;
    gap:1rem;
    position: relative;
  }
  .heart{
    width:min(70vmin, 500px);
    filter: drop-shadow(0 0 22px rgba(255,59,97,.35));
    cursor: pointer;
    transition: transform 0.2s ease;
    position: relative;
    z-index: 1;
  }
  .heart path.outline{
    fill: none;
    stroke: var(--stroke);
    stroke-width: 4;
    stroke-linecap: round;
    stroke-linejoin: round;
    stroke-dasharray: 1000;
    stroke-dashoffset: 1000;
    transition: stroke-dashoffset 2.5s ease-in-out;
  }
  .heart path.fill{
    fill: transparent;
    stroke: none;
    transition: fill 0.5s ease-in-out;
  }
  .heart.battement path.fill{
    fill: var(--fill);
    animation: heartbeat 1.2s infinite;
  }
  @keyframes heartbeat{
    0%,100%{ transform: scale(1); filter: drop-shadow(0 0 16px rgba(255,59,97,.35)); }
    25%{ transform: scale(1.06); filter: drop-shadow(0 0 26px rgba(255,59,97,.55)); }
    40%{ transform: scale(1); }
    60%{ transform: scale(1.04); }
  }
  .cover-circle{
    fill: #24243e;
    transition: r 0.8s ease-in-out, opacity 0.8s ease-in-out;
  }
  .cover-circle.hide{
    r: 0;
    opacity: 0;
  }
  .caption{
    font-weight:700;
    letter-spacing:.08em;
    opacity:0;
    text-align:center;
    transition: opacity 1s ease-in-out;
  }
  .caption.show{
    opacity:1;
  }
  form{
    display:flex;
    flex-direction:column;
    gap:0.5rem;
    background: rgba(0,0,0,0.7);
    padding: 1rem;
    border-radius: 10px;
    width: 90%;
    max-width: 400px;
    text-align:left;
    opacity: 0;
    transform: scale(0.8);
    transition: opacity 0.8s ease, transform 0.8s ease;
  }
  form.show{
    opacity: 1;
    transform: scale(1);
  }
  input, textarea, button{
    padding:0.5rem;
    border-radius:5px;
    border:none;
    outline:none;
  }
  button{
    background: var(--fill);
    color:#fff;
    cursor:pointer;
    font-weight: bold;
  }
  .particle{
    position: absolute;
    width: 10px;
    height: 10px;
    background: var(--fill);
    border-radius: 50%;
    pointer-events: none;
    opacity: 1;
    animation: explode 0.8s forwards;
  }
  @keyframes explode{
    0%{ transform: translate(0,0) scale(1); opacity:1;}
    100%{ transform: translate(var(--x), var(--y)) scale(0); opacity:0;}
  }
  /* Styles pour le timer et texte apr√®s soumission du formulaire */
  #timer {
    font-size: 1.2rem;
    margin-bottom: 2rem;
    font-weight: bold;
  }
  #resultBox {
    text-align:center;
    max-width:400px;
    background:rgba(0,0,0,0.7);
    padding:1rem;
    border-radius:10px;
  }
  #goTracker {
    margin-top:1rem;
    padding:0.5rem 1rem;
    border:none;
    border-radius:5px;
    background:#ff3b61;
    color:white;
    cursor:pointer;
  }
  /* animation c≈ìur avec nom */
  .heartNameSVG {
    transform: scale(0);
    opacity: 0;
    transition: transform 0.6s ease, opacity 0.6s ease;
  }
  .heartNameSVG.show {
    transform: scale(1);
    opacity: 1;
  }
</style>
</head>
<body>
<div class="wrap" id="wrap">
  <svg class="heart" id="heart" viewBox="0 0 100 100" aria-label="C≈ìur">
    <circle class="cover-circle" id="cover" cx="50" cy="50" r="50"/>
    <path class="outline"
      d="M50,18
         C41,-2,10,4,10,30
         C10,55,35,67,50,85
         C65,67,90,55,90,30
         C90,4,59,-2,50,18 Z"/>
    <path class="fill"
      d="M50,18
         C41,-2,10,4,10,30
         C10,55,35,67,50,85
         C65,67,90,55,90,30
         C90,4,59,-2,50,18 Z"/>
  </svg>
  <div class="caption" id="caption">Toi seule fais danser les battements de mon c≈ìur au rythme de chaque instant... Je t'aime ‚ù§Ô∏è</div>
</div>

<audio id="music" src="careless_whisper.mp3"></audio>

<script>
const heart = document.getElementById('heart');
const outline = heart.querySelector('.outline');
const cover = document.getElementById('cover');
const caption = document.getElementById('caption');
const wrap = document.getElementById('wrap');
const music = document.getElementById('music');

let activated = false;
let clickCount = 0;
let clickTimer;

heart.addEventListener('click', () => {
    clickCount++;
    
    if(clickCount === 1){
        clickTimer = setTimeout(()=>{ clickCount=0; }, 1000);
    }

    if(clickCount >= 3){
        clearTimeout(clickTimer);
        explodeHeart();
        return;
    }

    if (activated) return;
    activated = true;

    cover.classList.add('hide');
    setTimeout(() => { outline.style.strokeDashoffset = '0'; }, 300);
    setTimeout(() => {
        heart.classList.add('battement');
        music.play().then(() => {
            document.title = "Mon c≈ìur bat pour toi ‚ù§Ô∏è";
            caption.classList.add('show');
        }).catch(err => console.log("Lecture bloqu√©e :", err));
    }, 1100);
});

function explodeHeart(){
    const rect = heart.getBoundingClientRect();
    const particles = [];
    for(let i=0;i<30;i++){
        const p = document.createElement('div');
        p.className = 'particle';
        const angle = Math.random()*2*Math.PI;
        const radius = 100 + Math.random()*50;
        p.style.setProperty('--x', `${Math.cos(angle)*radius}px`);
        p.style.setProperty('--y', `${Math.sin(angle)*radius}px`);
        p.style.left = `${rect.left + rect.width/2}px`;
        p.style.top = `${rect.top + rect.height/2}px`;
        document.body.appendChild(p);
        particles.push(p);
    }
    heart.style.opacity = 0;
    setTimeout(()=> {
        wrap.innerHTML = `
          <form id="dateForm">
            <h3>Planifions un Date ensemble ‚ù§Ô∏è</h3>
            <label>Nom:</label>
            <input type="text" placeholder="Celle qui appara√Æt dans mes r√™ves..." required />
            <label>Date:</label>
            <input type="date" required />
            <label>Heure:</label>
            <input type="time" required />
            <label>Message:</label>
            <textarea placeholder="Un petit mot..." rows="3"></textarea>
            <button type="submit">Envoyer</button>
          </form>
        `;
        const form = document.getElementById('dateForm');
        setTimeout(()=>form.classList.add('show'),50);

        form.addEventListener('submit', function(e){
            e.preventDefault();

            const name = form.querySelector('input[type="text"]').value;
            const dateStr = form.querySelector('input[type="date"]').value;
            const timeStr = form.querySelector('input[type="time"]').value;
            const targetDate = new Date(`${dateStr}T${timeStr}`);

            const firstLetter = name.charAt(0).toUpperCase(); // Premi√®re lettre du nom
            wrap.innerHTML = `
            <div id="resultBox">
                <div id="timer"></div>
                <p>J‚Äôattendrai l‚Äô√©ternit√© s‚Äôil le faut pour contempler, ne serait-ce qu‚Äôun instant de plus, l‚Äô√©clat de ton doux visage.</p>
                <div id="heartNameContainer" style="margin-top:2rem; display:flex; justify-content:center; align-items:center; flex-direction:column;">
                    <svg viewBox="0 0 100 100" class="heartNameSVG" style="width:150px; height:150px;">
                        <path d="M50,18 C41,-2,10,4,10,30 C10,55,35,67,50,85 C65,67,90,55,90,30 C90,4,59,-2,50,18 Z" 
                            fill="#ff3b61" stroke="#ff2d55" stroke-width="4"/>
                        <text x="50" y="48" text-anchor="middle" font-size="20" fill="#fff" font-weight="bold" font-family="sans-serif">
                            ${firstLetter} + N
                        </text>
                    </svg>
                </div>
                <button id="goTracker">Ce n'est qu'un au-revoir</button>
            </div>
            `;


            setTimeout(() => {
                document.querySelector('.heartNameSVG').classList.add('show');
            }, 50);

            function updateTimer() {
                const now = new Date();
                const diff = targetDate - now;

                if (diff <= 0) {
                    document.getElementById('timer').textContent = "C'est le moment de notre rendez-vous ‚ù§Ô∏è";
                    clearInterval(timerInterval);
                    return;
                }

                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
                const minutes = Math.floor((diff / (1000 * 60)) % 60);
                const seconds = Math.floor((diff / 1000) % 60);

                document.getElementById('timer').textContent =
                    `${days}j ${hours}h ${minutes}m ${seconds}s avant notre rendez-vous üíï`;
            }

            const timerInterval = setInterval(updateTimer, 1000);
            updateTimer();

            document.getElementById('goTracker').addEventListener('click', () => {
                window.location.href = "index.html";
            });
        });
    }, 800);

    setTimeout(()=>particles.forEach(p=>p.remove()),800);
}
</script>

</body>
</html>
